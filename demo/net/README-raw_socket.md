柏克莱封包过滤器（Berkeley Packet Filter，缩写 BPF）

使用 raw socket 进行网络底层抓包, 注意，网卡需要开启混杂模式、其次程序运行需要root权限

# tcpdump -i enp1s0 'arp[4:4]=0x06040002' -dd -s 0
{ 0x28, 0, 0, 0x0000000c },
{ 0x15, 0, 3, 0x00000806 },
{ 0x20, 0, 0, 0x00000012 },
{ 0x15, 0, 1, 0x06040002 },
{ 0x6, 0, 0, 0x00040000 },
{ 0x6, 0, 0, 0x00000000 },

实际上，可以使用tcpdump -d查看具体code的行为，如下，类似汇编语言，相对而言可读性高一点了（当然前提你需要熟悉二三层协议）。

# tcpdump -i enp1s0 'arp[4:4]=0x06040002' -d -s 0
(000) ldh      [12]                             # 数据偏移12字节
(001) jeq      #0x806           jt 2	jf 5    # 是0x806，即arp协议,则跳到2，否则跳到5
(002) ld       [18]                             # 数据偏移18字节
(003) jeq      #0x6040002       jt 4	jf 5    # 若是0x06040002，跳到4，否则跳到5
(004) ret      #262144
(005) ret      #0
